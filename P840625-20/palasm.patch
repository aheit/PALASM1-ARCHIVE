# patch for PALASM1-ARCHIVE
# 
# This file is part of PALASM1-ARCHIVE
# 
# PALASM1-ARCHIVE is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# PALASM1-ARCHIVE is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with PALASM1-ARCHIVE.  If not, see <https://www.gnu.org/licenses/>.
#
# Author: Andreas Heitmann
# Date: 2025-01-08
#
diff --strip-trailing-cr --unified orig/pal20.for new/pal20.for
--- orig/pal20.for	2025-01-08 15:03:05.825087600 +0100
+++ new/pal20.for	2025-01-08 15:09:59.020452200 +0100
@@ -16,13 +16,13 @@
 C
       INTEGER FUNCTION KREAD(LUN,L1,L2,FILE)
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 FILE(20)
+      CHARACTER*1 FILE(20)
       LOGICAL FLAG
       J=21
 10    J=J-1
       IF (J .EQ. 0) GOTO 20
       IF (FILE(J) .NE. ' ') GOTO 20
-      FILE(J)=0
+      FILE(J)=CHAR(0)
       GOTO 10
 20    FLAG=IOREAD (LUN,L1,L2,FILE)
       KREAD=0
@@ -32,13 +32,13 @@
 C
       INTEGER FUNCTION KWRIT(LUN,L1,L2,FILE)
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 FILE(20)
+      CHARACTER*1 FILE(20)
       LOGICAL FLAG
       J=21
 10    J=J-1
       IF (J .EQ. 0) GOTO 20
       IF (FILE(J) .NE. ' ') GOTO 20
-      FILE(J)=0
+      FILE(J)=CHAR(0)
       GOTO 10
 20    FLAG=IOWRIT (LUN,L1,L2,FILE)
       KWRIT=0
@@ -134,39 +134,56 @@
 C
 C****************
 C
+C PATCHES FOR GFORTRAN COMPILER
+C (C) 2024 ANDREAS HEITMANN
+C
+C****************
+C
 C     MAIN PROGRAM
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80),ISAVE(64,32)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 CPG(9999),CLN(80),ISAVE(64,32)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
 C
-      INTEGER*1 FILE1(20),FILE2(20)
+      CHARACTER*1 FILE1(20),FILE2(20)
+      INTEGER KCLOS
+      INTEGER*1 LUN
 C
-      INTEGER IC,IL,IC1,I,J,K,ILE,ILL,COUNT,ISAF,I8PRO,I88PRO,IONE
+      INTEGER IC,IL,IC1,I,K,ILE,ILL,COUNT,ISAF,I8PRO,I88PRO
       INTEGER IPROD,IBLOW,ILERR,IPCTR,IPCTR0,IPCTR1,ISA0,ISA1,IFAULT
-C
+      INTEGER*1 ITYPE, IPRD,ITRM,J
+C     
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR,
      1        LFX,LFIRST,LFUSES(32,64),LPHASE(20),LBUF(20),LPOLAR(20),
      2        LPROD(80),LSAME,LACT,LOPERR,LINP,LPRD,LERR,LSA11,LSA01,
      3        LPHANT(32,64),DOIT
-      INTEGER*1 IBUF(8,20),ISYM(8,20)
+      CHARACTER*1 IBUF(8,20),ISYM(8,20)
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       COMMON /FPLOT/ ISAVE
       COMMON /LFUZ/LFUSES,LPHANT
       INTEGER IFUNCT,IDESC,IEND,IINPUT,IMATCH,SINGLE
       COMMON /FTEST/ IFUNCT,IDESC,IEND
+      INTEGER KREAD, KWRIT
 C
+      CHARACTER E,O,T,P,B,H,S,L,N,C,Q,U,F,R,A,JJ,X,D,IBLANK,CHY,CHN,BB
+     $     ,CC,DD,EE,FF,II,NN,OO,PP,RR,SS,TT,UU,BEL,FFEED,TAB
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER, PARAMETER :: FFEEDP = CHAR(12)
+      INTEGER*1 IZERO,IONE,ITWO
       DATA E/'E'/,O/'O'/,T/'T'/,P/'P'/,B/'B'/,H/'H'/,S/'S'/,L/'L'/,
      1     N/'N'/,C/'C'/,Q/'Q'/,U/'U'/,F/'F'/,R/'R'/,A/'A'/,JJ
      2     /'J'/,X/'X'/,D/'D'/,IBLANK/' '/,CHY/'Y'/,CHN/'N'/
       DATA BB/'B'/,CC/'C'/,DD/'D'/,EE/'E'/,FF/'F'/,II/'I'/,NN/'N'/,
      1     OO/'O'/,PP/'P'/,RR/'R'/,SS/'S'/,TT/'T'/,UU/'U'/
-      DATA BEL /007/, FFEED /012/,IONE/1/,TAB/09/
+      DATA BEL /BELP/, FFEED /FFEEDP/,IONE/1/,TAB/TABP/
+      DATA IZERO/0/,ITWO/2/
 C
 C
       CALL IOINIT
@@ -187,14 +204,14 @@
     2 FORMAT(/,' WHAT IS THE SOURCE FILENAME (d:filename.ext) ?: '$)
       READ(CONINP,3) (FILE1(I),I=1,20)
     3 FORMAT(20A1)
-      IF(KREAD(FILINP,2,0,FILE1) .NE. 0) GO TO 130
+      IF(KREAD(FILINP,ITWO,IZERO,FILE1) .NE. 0) GO TO 130
     5 WRITE(CONOUT,333)
   333 FORMAT(/,' OUTPUT FILENAME -',
      1         ' PRESS <ENTER> FOR NO OUTPUT FILE ?: '$)
       READ(CONINP,3) (FILE2(I),I=1,20)
       LUN=CONOUT
       IF(FILE2(1).EQ.IBLANK) GO TO 9
-      IF(KWRIT(FILOUT,2,0,FILE2) .NE. 0) GO TO 130
+      IF(KWRIT(FILOUT,ITWO,IZERO,FILE2) .NE. 0) GO TO 130
       LUN=FILOUT
     9 RPD=FILINP
       POF=LUN
@@ -242,7 +259,7 @@
 C
       LNPTR=0
       LNMAX=0
-10    READ(RPD,14,ENDFILE=15) (CLN(IC),IC=1,80)
+10    READ(RPD,14,END=15) (CLN(IC),IC=1,80)
 14    FORMAT(80A1)
       WRITE(CONOUT,9001)
       LNMAX=LNMAX+1
@@ -473,10 +490,10 @@
   110 FORMAT(/,' ENTER OPERATION CODE: '$)
       IOP=IBLANK
 C      REWIND(ROC)    
-      READ(ROC,120,ENDFILE=350) IOP
+      READ(ROC,120,END=350) IOP
   350 CONTINUE
   120 FORMAT(A1)
-      IF (IOP .GT. CHY) IOP=IOP-32
+      IF (IOP .GT. CHY) IOP=CHAR(ICHAR(IOP)-ICHAR(' '))
       IF((IOP.EQ.SS.OR.IOP.EQ.JJ).AND.(POF.NE.CONOUT))
      1 WRITE(CONOUT,9005)
 9005  FORMAT(/,1X,'SIMULATING',/)
@@ -590,12 +607,13 @@
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
 C     I/O UNIT ASSIGNMENTS
 C
-      CONINP=1
-      CONOUT=1
+      CONINP=5
+      CONOUT=6
       FILINP=10
       FILOUT=11
 C
@@ -613,8 +631,9 @@
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
       INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
 C
@@ -626,6 +645,7 @@
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       INTEGER*1 TSTVEC(20, 109 )
       COMMON  /TSTVEC/ NTEST, TSTVEC
+      CHARACTER H,L,C,R,X,A,I0,I2,I4,I6,I8,P
       DATA H/'H'/,L/'L'/,C/'C'/,R/'R'/,X/'X'/,A/'A'/,
      1     I0/'0'/,I2/'2'/,I4/'4'/,I6/'6'/,I8/'8'/,P/'P'/
 C
@@ -679,19 +699,23 @@
 C      THE FOLLOWING OPERATION SYMBOL IF ANY
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80), CTMP
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
       INTEGER IC,IL,I
-      INTEGER*1 ISYM(8,20)
+      CHARACTER*1 ISYM(8,20)
       LOGICAL LX1,LFX,LPHASE(20),LXOR1
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER IBLANK,ILEFT,IAND,IOR,COMENT,
+     1     ISLASH,IEQUAL,IRIGHT,ICOLON,TAB
       DATA IBLANK/' '/,ILEFT/'('/,IAND/'*'/,IOR/'+'/,COMENT/';'/,
-     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/009/
+     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/TABP/
 C
       LFX=.FALSE.
       IF( .NOT.(LLEFT.OR.LAND.OR.LOR.OR.LEQUAL.OR.LRIGHT) ) GO TO 910
@@ -755,7 +779,7 @@
 C      BLANKS AND CHARACTERS AFTER ';' ARE IGNORED
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80), CTMP
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
@@ -766,8 +790,11 @@
 C
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER IBLANK,ILEFT,IAND,IOR,COMENT,
+     1     ISLASH,IEQUAL,IRIGHT,ICOLON,TAB
       DATA IBLANK/' '/,ILEFT/'('/,IAND/'*'/,IOR/'+'/,COMENT/';'/,
-     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/009/
+     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/TABP/
 C
       LBLANK=.FALSE.
       LXOR=.FALSE.
@@ -815,9 +842,10 @@
 C      AND THE PIN NAME IN THE PIN LIST OR FUNCTION TABLE PIN LIST
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 IBUF(8,20),ISYM(8,20)
+      CHARACTER*1 IBUF(8,20),ISYM(8,20)
       INTEGER I,J,IMATCH
       LOGICAL LMATCH
+      CHARACTER C,A,R,Y
       DATA C/'C'/,A/'A'/,R/'R'/,Y/'Y'/
 C
       J=0
@@ -875,18 +903,25 @@
 C     THIS SUBROUTINE EVALUATES THE FIXED SYMBOLS FOUND IN THE
 C      PAL16X4 AND PAL16A4
 C
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 CPG(9999),CLN(80)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
+      INTEGER*1 ITYPE
+      LOGICAL LPROD(80),LPOLAR(20),DOIT
+      INTEGER IPCTR
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
       LOGICAL LFUSES(32,64),LPHANT(32,64)
       COMMON /LFUZ/LFUSES,LPHANT
       LOGICAL LBUF(20),LFIRST,LMATCH,LFX
       INTEGER IC,IL,IBLOW,IPROD,I,IINPUT,J,ISUM1,IMATCH
-      INTEGER*1 TABLE(5,14),IBUF(8,20),FIXBUF(8)
+      CHARACTER A,B,ISLASH,IOR,IBLANK,IRIGHT,
+     1        IAND,N,Q,N0,N1,N2,N3,
+     2      ICOLON
+      CHARACTER*1 TABLE(5,14),IBUF(8,20),FIXBUF(8)
 C
       DATA A/'A'/,B/'B'/,ISLASH/'/'/,IOR/'+'/,IBLANK/' '/,IRIGHT/')'/,
      1        IAND/'*'/,N/'N'/,Q/'Q'/,N0/'0'/,N1/'1'/,N2/'2'/,N3/'3'/,
@@ -959,6 +994,7 @@
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
       WRITE (POF,5) (IPAL(J),J=1,4),INOAI,IOT,INOO,INOO1,
@@ -980,6 +1016,7 @@
 C     THIS SUBROUTINE PRINTS THE PALASM CATOLOG
 C
       IMPLICIT INTEGER*1 (A-Z)
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
       DATA BEL/007/
       WRITE(PMS,10)
@@ -1013,20 +1050,24 @@
      1 IPROD,LDUMP,ITYPE,LPROD,IOP,IBLOW,IPCTR0,LPOLAR,DOIT)
 C     THIS THIS SUBROUTINE PRODUCES THE FUSE PLOT
 C
-      IMPLICIT INTEGER*1 (A-Z)
+      IMPLICIT CHARACTER*1 (A-Z)
+      INTEGER*1 ITYPE
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
-      INTEGER*1 ISAVE(64,32)
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER*1 ISAVE(64,32)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /FPLOT/ ISAVE
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
       INTEGER IBLOW,IPCTR0,IPROD,IBLOW1,I,J,I8PRO,I88PRO
-      INTEGER*1 IBUF(8,20),IOUT(64),PWORD(20)
+      CHARACTER*1 IBUF(8,20),IOUT(64),PWORD(20)
       LOGICAL LBUF(20),LDUMP,LPROD(80),LPOLAR(20),DOIT
       LOGICAL LFUSES(32,64),LPHANT(32,64)
       COMMON /LFUZ/LFUSES,LPHANT
 C
+      CHARACTER IAND,IOR,ISLASH,HIFANT,L,H,
+     1     IDASH,X,IBLANK,P,B
       DATA IAND/'*'/,IOR/'+'/,ISLASH/'/'/,HIFANT/'O'/,L/'L'/,H/'H'/,
      1     IDASH/'-'/,X/'X'/,IBLANK/' '/,P/'P'/,B/'B'/
 C
@@ -1120,10 +1161,12 @@
       SUBROUTINE TWEEK(ITYPE,IOT)
 C     THIS SUBROUTINE TWEEKS LFUSES (THE PROGRAMMING FUSE PLOT)
 C      FOR HIGH AND LOW PHANTOM FUSES
-      IMPLICIT INTEGER*1 (A-Z)
+      IMPLICIT CHARACTER*1 (A-Z)
       INTEGER IPROD,IINPUT
+      INTEGER*1 ITYPE
       LOGICAL LFUSES(32,64),LPHANT(32,64)
       COMMON /LFUZ/LFUSES,LPHANT
+      CHARACTER L,C,P
       DATA L/'L'/,C/'C'/,P/'P'/
 C
       IF(ITYPE.GE.4) GO TO 20
@@ -1216,12 +1259,13 @@
 C     CORRESPONDING OUTPUT PIN
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
       INTEGER I,IBLOW,I88PRO
       LOGICAL LFUSES(32,64),LPHANT(32,64)
       COMMON /LFUZ/LFUSES,LPHANT
+      CHARACTER R,P,I1,I2,I4,I6,I8
       DATA R/'R'/,P/'P'/,I1/'1'/,I2/'2'/,I4/'4'/,I6/'6'/,I8/'8'/
 C
 C  THE NEXT LINE IS FOR THE 16RP6
@@ -1246,7 +1290,8 @@
 C
       IMPLICIT INTEGER*1 (A-Z)
       INTEGER I,I8PRO,IPROD
-      INTEGER*1 IOUT(64)
+      CHARACTER*1 IOUT(64)
+      CHARACTER X,IDASH,LOFANT,HIFANT
       DATA X/'X'/,IDASH/'-'/,LOFANT/'0'/,HIFANT/'O'/
 C
       DO 10 I=1,32
@@ -1281,35 +1326,44 @@
 C      AND GENERATES TEST VECTORS
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
 C
-      INTEGER IC,IL,IEQN,I,J,NVECT,IPCTR3,IC1,IL1,ILL,IINP,IMESS
+      INTEGER IC,IL,IEQN,J,NVECT,IPCTR3,IC1,IL1,ILL,IINP,IMESS
+      INTEGER*1 I
       INTEGER IEQN1,IPCTR4,ISAF,ISA0,ISA1,IPCTR1,IOUT,IOUTP
-      INTEGER NTEST,NERR,ITRST,IPCTR,IMAX,IONE,IIFB,PLOAD,ICLOCK
+      INTEGER NTEST,NERR,ITRST,IPCTR,IMAX,IIFB,PLOAD,ICLOCK
+      INTEGER*1 IONE
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR,
      1        LFX,LSAME,XORFND,LERR,LPHASE(20),LPHAS1(20),LBUF(20),
      2        LOUT(20),LOUTP(20),LCLOCK,LPTRST,LCTRST,LENABL(20),NREG,
      3        LSA11,LSA12,LSA01,LSA02,LPRINT,LLPOL(20),LPOLAR(20),
      4        LOADIT
-      INTEGER*1 IPROD,ISUM,XORSUM,ITEST 
-      INTEGER*1  ISYM(8,20),ISYM1(8,20),IBUF(8,20),IVECT(20),IPIN(20)
-      INTEGER*1  TSTVEC(20, 109 ),ISTATT(20),ISTATE(20),IVECTP(20)
+      CHARACTER*1 IPROD,ISUM,XORSUM,ITEST 
+      CHARACTER*1  ISYM(8,20),ISYM1(8,20),IBUF(8,20),IVECT(20)
+      INTEGER*1 IPIN(20)
+      CHARACTER*1  TSTVEC(20, 109 ),ISTATT(20),ISTATE(20),IVECTP(20)
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       INTEGER ILEQ,IFUNCT,IDESC,IEND,ILE,ILERR,IMATCH
       COMMON /FTEST/ IFUNCT,IDESC,IEND
       COMMON /TSTVEC/ NTEST,TSTVEC
 C
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER IDASH,L,H,X,P,Z,N0,
+     1     N1,ERR,IBLANK,COMENT,I4,I6,
+     2      NN,I8,C
+      CHARACTER BEL
       DATA IDASH/'-'/,L/'L'/,H/'H'/,X/'X'/,P/'P'/,Z/'Z'/,N0/'0'/,
      1     N1/'1'/,ERR/'?'/,IBLANK/' '/,COMENT/';'/,I4/'4'/,I6/'6'/,
      2      NN/'N'/,I8/'8'/,C/'C'/
-      DATA BEL/007/,IONE/1/
+      DATA BEL/BELP/,IONE/1/
 C
          NTEST = 0
 C     PRINT AN ERROR MESSAGE IF NO FUNCTION TABLE IS SUPPLIED
@@ -1789,8 +1843,8 @@
 C     THIS SUBROUTINE EVALUATES THE FIXED SYMBOLS FOUND IN THE
 C      PAL16X4 AND PAL16A4 FOR THE FUNCTION TABLE
 C
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 CPG(9999),CLN(80)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
@@ -1798,14 +1852,16 @@
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR,
      1        LFX,LPHAS1(20),LBUF(20),LCLOCK,NREG,TOR,TXOR,TXNOR,TAND,
      2        LPHASA,LPHASB
-      INTEGER IC,IL,IC1,IL1,IONE,IINP,IIFB
-      INTEGER*1 ISYM(8,20),ISYM1(8,20),IBUF(8,20),IVECT(20),IVECTP(20)
-      INTEGER*1 ITESTA,ITESTB
+      INTEGER IC,IL,IC1,IL1,IINP,IIFB
+      INTEGER*1 IONE
+      CHARACTER*1 ISYM(8,20),ISYM1(8,20),IBUF(8,20),IVECT(20),IVECTP(20)
+      CHARACTER*1 ITESTA,ITESTB
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
+      CHARACTER L,H,X,Z
       DATA L/'L'/,H/'H'/,X/'X'/,Z/'Z'/,IONE/1/
 C
 C     GET OUTPUT PIN AN (WHERE N=0,1,2,3)
-      CALL GETSYM(LBUF,IBUF,1,IC1,IL1,LFX)
+      CALL GETSYM(LBUF,IBUF,IONE,IC1,IL1,LFX)
       CALL MATCH(IINP,IBUF,ISYM1)
       ITESTA=IVECT(IINP)
       LPHASA = ( (     LBUF(1)).AND.(     LPHAS1(IINP)).OR.
@@ -1830,7 +1886,7 @@
       TXNOR = (LXNOR)
       TAND  = (LAND.AND.(.NOT.LXNOR))
 C     GET INPUT BN (WHERE N=0,1,2,3)
-      CALL GETSYM(LBUF,IBUF,1,IC1,IL1,LFX)
+      CALL GETSYM(LBUF,IBUF,IONE,IC1,IL1,LFX)
       CALL MATCH(IINP,IBUF,ISYM1)
       ITESTB=IVECT(IINP)
       LPHASB = ( (     LBUF(1)).AND.(     LPHAS1(IINP)).OR.
@@ -1859,15 +1915,23 @@
       SUBROUTINE HEX(IOP)
 C     THIS SUBROUTINE GENERATES INTEL & HEX PROGRAMMING FORMATS
 C
-      IMPLICIT INTEGER*1 (A-Z)
+      IMPLICIT CHARACTER*1 (A-Z)
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
       LOGICAL LFUSES(32,64),LPHANT(32,64)
       COMMON /LFUZ/LFUSES,LPHANT
-      INTEGER IHEX,ADDR,ISUM2,IPROD,CSUM,I,J,INC,IINPUT,HSUM,ZCSUM(4)
-      INTEGER*1   ZTABLE(16),ITEMP(32)
+      INTEGER IHEX,ADDR,ISUM2,IPROD,CSUM,I,J,INC,IINPUT,HSUM
+      CHARACTER ZCSUM(4)
+      CHARACTER*1   ZTABLE(16),ITEMP(32)
       DATA ZTABLE/'0','1','2','3','4','5','6','7','8','9',
      1  'A','B','C','D','E','F'/
-      DATA BEL/007/,SOH/1/,STX/2/,ETX/3/,IBLANK/' '/
+      CHARACTER, PARAMETER :: SOHP = CHAR(1)
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER, PARAMETER :: STXP = CHAR(2)
+      CHARACTER, PARAMETER :: ETXP = CHAR(3)
+      CHARACTER BEL,SOH,STX,ETX,IBLANK
+      CHARACTER CH,CI
+      DATA BEL/BELP/,SOH/SOHP/,STX/STXP/,ETX/ETXP/,IBLANK/' '/
       DATA CH/'H'/,CI/'I'/
 C
       HSUM=0
@@ -1927,17 +1991,19 @@
 C     THIS SUBROUTINE PRINTS THE PINOUT OF THE PAL
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
 C
       INTEGER I,J,IC,IL,II
-      INTEGER*1 IIN(7,2),PIN(12,20)
+      CHARACTER*1 IIN(7,2),PIN(12,20)
+      CHARACTER IBLANK,ISTAR
       DATA IBLANK/' '/,ISTAR/'*'/
 C
       DO 10 J=1,20
@@ -2016,19 +2082,25 @@
 C     THIS SUBROUTINE GENERATES THE JEDEC PROGRAMMING FORMAT WHICH IS
 C      COMPATIBLE WITH THE DATA I/O PROGRAMMABLE LOGIC PAK (PLDS)
 C
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 IPAL(4),INOAI,IOT,INOO,INOO1
-      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 IPAL(4),INOAI,IOT,INOO,INOO1
+      CHARACTER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INOAI,IOT,INOO,INOO1,REST,PATNUM,TITLE,COMP
+      INTEGER*1 CONINP,CONOUT,FILINP,PMS,POF,PDF,ROC,RPD
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
+      INTEGER*1 ITERM
+      INTEGER*1 ITYPE
       LOGICAL LFUSES(32,64),LPHANT(32,64),LPOLAR(20),DOIT
-      INTEGER*1 IPBUF(32),IDECIO(4)
+      CHARACTER*1 IPBUF(32),IDECIO(4)
       INTEGER NFUSE,NTEST,IADR,IPT,IINP,PINOUT,I,J,J1,J2,IGH
       COMMON /LFUZ/LFUSES,LPHANT
       INTEGER*1 TSTVEC(20, 109 )
       COMMON /TSTVEC/ NTEST,TSTVEC
-      DATA ZERO/'0'/,ONE/'1'/,STX/2/,ETX/3/,CH/'H'/,STAR/'*'/
+      CHARACTER, PARAMETER :: STXP = CHAR(2)
+      CHARACTER, PARAMETER :: ETXP = CHAR(3)
+      CHARACTER ZERO,ONE,STX,ETX,CH,STAR
+      DATA ZERO/'0'/,ONE/'1'/,STX/STXP/,ETX/ETXP/,CH/'H'/,STAR/'*'/
 C
       IADR=0
       IGH=0
@@ -2105,8 +2177,8 @@
 C
       SUBROUTINE ENCD(IDECIO,IADR)
 C
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 ICNV(16),IDECIO(4)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 ICNV(16),IDECIO(4)
       INTEGER IADR,IDEC(4),J
       DATA ICNV/'0','1','2','3','4','5','6','7','8','9',
      1  'A','B','C','D','E','F'/
@@ -2122,3 +2194,4 @@
       END
 C
 C****************
+
