# patch for PALASM1-ARCHIVE
# 
# This file is part of PALASM1-ARCHIVE
# 
# PALASM1-ARCHIVE is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# PALASM1-ARCHIVE is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with PALASM1-ARCHIVE.  If not, see <https://www.gnu.org/licenses/>.
#
# Author: Andreas Heitmann
# Date: 2025-01-08
#
diff --strip-trailing-cr --unified orig/pal24.for new/pal24.for
--- orig/pal24.for	2025-01-08 16:08:57.786318300 +0100
+++ new/pal24.for	2025-01-08 16:08:57.847266400 +0100
@@ -16,13 +16,13 @@
 C
       INTEGER FUNCTION KREAD(LUN,L1,L2,FILE)
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 FILE(20)
+      CHARACTER*1 FILE(20)
       LOGICAL FLAG
       J=21
 10    J=J-1
       IF (J .EQ. 0) GOTO 20
       IF (FILE(J) .NE. ' ') GOTO 20
-      FILE(J)=0
+      FILE(J)=CHAR(0)
       GOTO 10
 20    FLAG=IOREAD (LUN,L1,L2,FILE)
       KREAD=0
@@ -32,13 +32,13 @@
 C
       INTEGER FUNCTION KWRIT(LUN,L1,L2,FILE)
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 FILE(20)
+      CHARACTER*1 FILE(20)
       LOGICAL FLAG
       J=21
 10    J=J-1
       IF (J .EQ. 0) GOTO 20
       IF (FILE(J) .NE. ' ') GOTO 20
-      FILE(J)=0
+      FILE(J)=CHAR(0)
       GOTO 10
 20    FLAG=IOWRIT (LUN,L1,L2,FILE)
       KWRIT=0
@@ -113,26 +113,32 @@
 C
 C***************************************
 C
+C PATCHES FOR GFORTRAN COMPILER
+C (C) 2024 ANDREAS HEITMANN
 C
-C     MAIN PROGRAM
+C***************************************
 C
-      IMPLICIT INTEGER*1 (A-Z)
 C
-      INTEGER*1 CPG(9999),CLN(80),ISAVE(80,40)
+C     MAIN PROGRAM
+      IMPLICIT INTEGER*1 (A-Z)
+      CHARACTER*1 CPG(9999),CLN(80),ISAVE(80,40)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
       COMMON /FPLOT/ ISAVE
 C
-      INTEGER*1 FILE1(20),FILE2(20)
+      CHARACTER*1 FILE1(20),FILE2(20)
 C
       INTEGER IC,IL,IC1,I,J,K,ILE,ILL,COUNT,ISAF,I8PRO,I88PRO,ITYPE
       INTEGER IPROD,IBLOW,ILERR,IPCTR,IPCTR0,IPCTR1,ISA0,ISA1,IFAULT
 C
-      INTEGER IDESC,IEND,IFUNCT,IINPUT,IMATCH,IOT,IONE,SINGLE
-      INTEGER*1 ISYM(8,24),IBUF(8,24),JPROD(80)
-      INTEGER*1 IPAL(3),INAME(5),REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER IOT
+      INTEGER IDESC,IEND,IFUNCT,IINPUT,IMATCH,IONE,SINGLE
+      CHARACTER*1 ISYM(8,24),IBUF(8,24)
+      INTEGER*1 JPROD(80)
+      CHARACTER*1 IPAL(3)
+      CHARACTER*1 INAME(5),REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INAME,REST,PATNUM,TITLE,COMP
 C
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LFIRST,
@@ -142,12 +148,26 @@
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR
       COMMON /LFUZ/LFUSES,LPHANT
       COMMON /FTEST/ IFUNCT,IDESC,IEND
+      INTEGER KREAD, KWRIT
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER, PARAMETER :: FFEEDP = CHAR(12)
+      INTEGER*1 IZERO,ITWO
+      CHARACTER*1 E,O,T,P,B,D,H,S,
+     1     L,N,C,Q,U,F,Y
       DATA E/'E'/,O/'O'/,T/'T'/,P/'P'/,B/'B'/,D/'D'/,H/'H'/,S/'S'/,
      1     L/'L'/,N/'N'/,C/'C'/,Q/'Q'/,U/'U'/,F/'F'/,Y/'Y'/
+      CHARACTER*1 BB,CC,DD,EE,FF,II,NN,
+     1     OO,PP,RR,SS,TT,UU,JJ
       DATA BB/'B'/,CC/'C'/,DD/'D'/,EE/'E'/,FF/'F'/,II/'I'/,NN/'N'/,
      1     OO/'O'/,PP/'P'/,RR/'R'/,SS/'S'/,TT/'T'/,UU/'U'/,JJ/'J'/
-      DATA BEL/07/,IBLANK/' '/,IONE/1/,CHY/'Y'/,CHN/'N'/
-      DATA FFEED/012/,TAB/09/
+      CHARACTER*1 BEL,IBLANK,CHY,CHN
+      DATA BEL/BELP/,IBLANK/' '/,IONE/1/,CHY/'Y'/,CHN/'N'/
+      CHARACTER*1 FFEED,TAB
+      DATA FFEED/FFEEDP/,TAB/TABP/
+      DATA IZERO/0/,ITWO/2/
+      CHARACTER*1 IOP
+      INTEGER KCLOS
 C
       CALL IOINIT
       ROC=CONINP
@@ -167,14 +187,14 @@
     2 FORMAT(/,' WHAT IS THE SOURCE FILENAME (d:filename.ext) ?: '$)
       READ(CONINP,3) (FILE1(I),I=1,20)
     3 FORMAT(20A1)
-      IF(KREAD(FILINP,2,0,FILE1) .NE. 0) GO TO 130
+      IF(KREAD(FILINP,ITWO,IZERO,FILE1) .NE. 0) GO TO 130
     5 WRITE(CONOUT,333)
   333 FORMAT(/,' OUTPUT FILENAME -',
      1         ' PRESS <ENTER> FOR NO OUTPUT FILE ?: '$)
       READ(CONINP,3) (FILE2(I),I=1,20)
       LUN=CONOUT
       IF(FILE2(1).EQ.IBLANK) GO TO 9
-      IF(KWRIT(FILOUT,2,0,FILE2) .NE. 0) GO TO 130
+      IF(KWRIT(FILOUT,ITWO,IZERO,FILE2) .NE. 0) GO TO 130
       LUN=FILOUT
     9 RPD=FILINP
       POF=LUN
@@ -215,7 +235,7 @@
 C
       LNPTR=0
       LNMAX=0
-10    READ(RPD,14,ENDFILE=15) (CLN(IC),IC=1,80)
+10    READ(RPD,14,END=15) (CLN(IC),IC=1,80)
 14    FORMAT(80A1)
       WRITE(CONOUT,9001)
       LNMAX=LNMAX+1
@@ -376,7 +396,7 @@
                 IBLOW = IBLOW - 1
                 LFUSES(IINPUT,IPROD)=.FALSE.
                 CALL PLOT(LBUF,IBUF,IPROD,.FALSE.,ITYPE,
-     1                    LPROD,IOP,IBLOW)
+     1                    LPROD,IOP,IBLOW,0)
    60           IF(LAND) GO TO 50
    64           IF(.NOT.LRIGHT) GO TO 68
    66           CALL INCR(IC,IL)
@@ -419,10 +439,10 @@
   110 FORMAT(/,' ENTER OPERATION CODE: '$)
       IOP=IBLANK
 C      REWIND(ROC)
-      READ(ROC,120,ENDFILE=750) IOP
+      READ(ROC,120,END=750) IOP
   120 FORMAT(A1)
   750 CONTINUE
-      IF (IOP .GT. Y) IOP=IOP-32
+      IF (IOP .GT. Y) IOP=CHAR(ICHAR(IOP)-ICHAR(' '))
       IF((IOP.EQ.SS.OR.IOP.EQ.JJ).AND.(POF.NE.CONOUT))
      1 WRITE(CONOUT,9005)
 9005  FORMAT(/,1X,'SIMULATING',/)
@@ -438,7 +458,7 @@
      2                  IOP.NE.JJ)
       IF (IOP.NE.JJ) GOTO 140
       CALL TEST(LPHASE,LBUF,IC,IL,ILE,ISYM,IBUF,
-     1           ITYPE,IPCTR,LERR,ISAF,IPCTR1,.FALSE.,.FALSE.,.FALSE.,
+     1           ITYPE,IPCTR,LERR,ISAF,IPCTR1,.FALSE.,.FALSE.,
      2           IOP.NE.JJ)
       CALL JEDEC(ITYPE,IOT,DOIT)
   140 ISAF=0
@@ -520,8 +540,8 @@
 C
 C     I/O UNIT ASSIGNMENTS
 C
-      CONINP=1
-      CONOUT=1
+      CONINP=5
+      CONOUT=6
       FILINP=10
       FILOUT=11
 C
@@ -540,7 +560,8 @@
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
 C
-      INTEGER*1 INAME(5),INFO(6,14)
+      CHARACTER*1 INAME(5)
+      INTEGER*1 INFO(6,14)
       INTEGER I,J,IBLOW,IC,IL,IPCTR,ITYPE,NTEST
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LFUSES(40,80),
      1        LMATCH,LXOR,LPHANT(40,80)
@@ -548,14 +569,29 @@
       COMMON /LFUZ/LFUSES,LPHANT
       INTEGER*1 TSTVEC(24, 109 )
       COMMON /TSTVEC/ NTEST,TSTVEC
+      INTEGER*1, PARAMETER :: I0 = ICHAR('0') 
+      INTEGER*1, PARAMETER :: I1 = ICHAR('1') 
+      INTEGER*1, PARAMETER :: I2 = ICHAR('2') 
+      INTEGER*1, PARAMETER :: I3 = ICHAR('3') 
+      INTEGER*1, PARAMETER :: I4 = ICHAR('4') 
+      INTEGER*1, PARAMETER :: I5 = ICHAR('5') 
+      INTEGER*1, PARAMETER :: I6 = ICHAR('6') 
+      INTEGER*1, PARAMETER :: I7 = ICHAR('7') 
+      INTEGER*1, PARAMETER :: I8 = ICHAR('8') 
+      INTEGER*1, PARAMETER :: I9 = ICHAR('9') 
+      INTEGER*1, PARAMETER :: ISP= ICHAR(' ') 
+      INTEGER*1, PARAMETER :: ICC= ICHAR('C') 
+      INTEGER*1, PARAMETER :: ILL= ICHAR('L') 
+      INTEGER*1, PARAMETER :: IR = ICHAR('R') 
+      INTEGER*1, PARAMETER :: IX = ICHAR('X') 
       DATA INFO
-     1    /'1','2','L','1','0',1,'1','4','L','8',' ',2,
-     2     '1','6','L','6',' ',3,'1','8','L','4',' ',4,
-     3     '2','0','L','2',' ',5,'2','0','C','1',' ',6,
-     4     '2','0','L','1','0',7,'2','0','X','1','0',8,
-     5     '2','0','X','8',' ',9,'2','0','X','4',' ',10,
-     6     '2','0','L','8',' ',11,'2','0','R','8',' ',12,
-     7     '2','0','R','6',' ',13,'2','0','R','4',' ',14/
+     1    /I1 ,I2 ,ILL,I1 ,I0 ,1,I1 ,I4 ,ILL,I8 ,ISP,2,
+     2     I1 ,I6 ,ILL,I6 ,ISP,3,I1 ,I8 ,ILL,I4 ,ISP,4,
+     3     I2 ,I0 ,ILL,I2 ,ISP,5,I2 ,I0 ,ICC,I1 ,ISP,6,
+     4     I2 ,I0 ,ILL,I1 ,I0 ,7,I2 ,I0 ,IX ,I1 ,I0 ,8,
+     5     I2 ,I0 ,IX ,I8 ,ISP,9,I2 ,I0 ,IX ,I4 ,ISP,10,
+     6     I2 ,I0 ,ILL,I8 ,ISP,11,I2 ,I0 ,IR ,I8 ,ISP,12,
+     7     I2 ,I0 ,IR ,I6 ,ISP,13,I2 ,I0 ,IR ,I4 ,ISP,14/
 C
 C     INITIALIZE LFUSES ARRAY (FUSE ARRAY)
       DO 20 J=1,80
@@ -579,7 +615,7 @@
       DO 40 J=1,14
          LMATCH=.TRUE.
          DO 30 I=1,4
-   30       IF(INAME(I).NE.INFO(I,J)) LMATCH=.FALSE.
+   30       IF(INAME(I).NE.CHAR(INFO(I,J))) LMATCH=.FALSE.
          IF(LMATCH) ITYPE=INFO(6,J)
          IF (LMATCH) GO TO 50
    40 CONTINUE
@@ -595,19 +631,22 @@
 C      THE FOLLOWING OPERATION SYMBOL IF ANY
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80), CTMP
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
       INTEGER IC,IL,I,J
-      INTEGER*1 ISYM(8,24)
+      CHARACTER*1 ISYM(8,24)
       LOGICAL LX1,LPHASE(24),LXOR1
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER IBLANK,ILEFT,IAND,IOR,COMENT,
+     1     ISLASH,IEQUAL,IRIGHT,ICOLON,TAB
       DATA IBLANK/' '/,ILEFT/'('/,IAND/'*'/,IOR/'+'/,COMENT/';'/,
-     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/009/
+     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/TABP/
 C
       IF((LLEFT.OR.LAND.OR.LOR.OR.LEQUAL.OR.LRIGHT) ) CALL INCR(IC,IL)
       LPHASE(J)=(.NOT.LSLASH)
@@ -660,7 +699,7 @@
 C      BLANKS AND CHARACTERS AFTER ';' ARE IGNORED
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80), CTMP
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
@@ -671,8 +710,11 @@
 C
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LXNOR
+      CHARACTER, PARAMETER :: TABP = CHAR(9)
+      CHARACTER IBLANK,ILEFT,IAND,IOR,COMENT,
+     1     ISLASH,IEQUAL,IRIGHT,ICOLON,TAB
       DATA IBLANK/' '/,ILEFT/'('/,IAND/'*'/,IOR/'+'/,COMENT/';'/,
-     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/009/
+     1     ISLASH/'/'/,IEQUAL/'='/,IRIGHT/')'/,ICOLON/':'/,TAB/TABP/
 C
       LBLANK=.FALSE.
       LXOR=.FALSE.
@@ -714,7 +756,7 @@
 C      AND THE PIN NAME IN THE PIN LIST OR FUNCTION TABLE PIN LIST
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 IBUF(8,24),ISYM(8,24)
+      CHARACTER*1 IBUF(8,24),ISYM(8,24)
       INTEGER I,J,IMATCH
       LOGICAL LMATCH
 C
@@ -828,15 +870,18 @@
 C     THIS SUBROUTINE PRINTS THE PINOUT OF THE PAL
       IMPLICIT INTEGER*1 (A-Z)
 C
-      INTEGER*1 CPG(9999),CLN(80),PIN(12,24)
+      CHARACTER*1 CPG(9999),CLN(80),PIN(12,24)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
-      INTEGER IC,IL,IBLOW,IPROD,IPCTRO,ITYPE,IIN(8,2),I,J,K,II
-      INTEGER*1 IPAL(3),INAME(5),REST(72),PATNUM(80),TITLE(80),COMP(80)
+      CHARACTER IIN(8,2)
+      INTEGER IC,IL,IBLOW,IPROD,IPCTRO,ITYPE,I,J,K,II
+      CHARACTER*1 IPAL(3),INAME(5)
+      INTEGER*1 REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INAME,REST,PATNUM,TITLE,COMP
+      CHARACTER IBLANK,ISTAR
       DATA IBLANK/' '/,ISTAR/'*'/
       DO 10 J=1,24
           DO 5 I=1,12
@@ -914,8 +959,8 @@
       SUBROUTINE PLOT(LBUF,IBUF,IPROD,LDUMP,ITYPE,LPROD,
      1                IOP,IBLOW,IPCTR0)
 C     THIS SUBROUTINE PRODUCES THE FUSE PLOT
-      IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 ISAVE(80,40),IOUT(64),IDATA(40),IBUF(8,24)
+      IMPLICIT CHARACTER*1 (A-Z)
+      CHARACTER*1 ISAVE(80,40),IOUT(64),IDATA(40),IBUF(8,24)
       INTEGER I,J,I88PRO,I8PRO,IBLOW,ITYPE,K,IPCTR0,IPROD
       LOGICAL LBUF(24),LFUSES(40,80),LDUMP,LPROD(80),LPHANT(40,80)
 C
@@ -925,7 +970,12 @@
       COMMON /FPLOT/ ISAVE
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
 C
-      DATA IAND/'*'/,IOR/'+'/,ISLASH/'/'/,STX/002/,ETX/003/,
+      CHARACTER, PARAMETER :: STXP = CHAR(2)
+      CHARACTER, PARAMETER :: ETXP = CHAR(3)
+      CHARACTER IAND,IOR,ISLASH,STX,ETX,
+     1     IDASH,X,IBLANK,P,B,
+     2     D,ZERO,ONE,FX,FIDASH
+      DATA IAND/'*'/,IOR/'+'/,ISLASH/'/'/,STX/STXP/,ETX/ETXP/,
      1     IDASH/'-'/,X/'X'/,IBLANK/' '/,P/'P'/,B/'B'/,
      2     D/'D'/,ZERO/'0'/,ONE/'1'/,FX/'0'/,FIDASH/'O'/
 C
@@ -1026,14 +1076,15 @@
 C
 C***************************************
 C
-      SUBROUTINE JEDEC(ITYPE,IOT)
+      SUBROUTINE JEDEC(ITYPE,IOT,DOIT)
 C     THIS SUBROUTINE GENERATES THE JEDEC PROGRAMMING FORMAT WHICH IS
 C      COMPATIBLE WITH THE DATA I/O PROGRAMMABLE LOGIC PAK (PLDS)
       IMPLICIT INTEGER*1 (A-Z)
       LOGICAL DOIT,LFUSES(40,80),LPHANT(40,80)
-      INTEGER I,J,ITYPE,L,NFUSE,NTEST,IOT
+      CHARACTER IOT
+      INTEGER I,J,ITYPE,L,NFUSE,NTEST
       INTEGER IADR,IPT,IINP,J1,J2,PINOUT(2)
-      INTEGER*1 IPBUF(40),IDECIO(4)
+      CHARACTER*1 IPBUF(40),IDECIO(4)
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
       COMMON /LFUZ/LFUSES,LPHANT
       COMMON /BLK/ PR8X10(10,14),PROD8(8,11),PRODLN(40,7)
@@ -1042,7 +1093,10 @@
       INTEGER*1 IPAL(3),INAME(5),REST(72),PATNUM(80),TITLE(80),COMP(80)
       COMMON /SPEC/ IPAL,INAME,REST,PATNUM,TITLE,COMP
 C
-      DATA ZERO/'0'/,ONE/'1'/,STX/2/,ETX/3/,CH/'H'/,STAR/'*'/
+      CHARACTER ZERO,ONE,STX,ETX,CH,STAR
+      CHARACTER, PARAMETER :: STXP = CHAR(2)
+      CHARACTER, PARAMETER :: ETXP = CHAR(3)
+      DATA ZERO/'0'/,ONE/'1'/,STX/STXP/,ETX/ETXP/,CH/'H'/,STAR/'*'/
       IADR=0
       IF (ITYPE.NE.11) GOTO 333
       PINOUT(1) = 2
@@ -1115,7 +1169,7 @@
       SUBROUTINE ENCD(IDECIO,IADR)
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 ICNV(16),IDECIO(4)
+      CHARACTER*1 ICNV(16),IDECIO(4)
       INTEGER IADR,IDEC(4),J
       DATA ICNV/'0','1','2','3','4','5','6','7','8','9',
      1  'A','B','C','D','E','F'/
@@ -1172,7 +1226,9 @@
      1        LEQUAL,LRIGHT,LXOR,LPHANT(40,80)
       COMMON /LFUZ/LFUSES,LPHANT
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR
+      CHARACTER*1 PRODLN
       COMMON /BLK/ PR8X10(10,14),PROD8(8,11),PRODLN(40,7)
+      CHARACTER P,N
       DATA P/'P'/,N/'N'/
       FUSPTR=1
       DO 30 OUTPUT=1,10
@@ -1229,12 +1285,15 @@
 C     THIS SUBROUTINE UPDATES IOUT (THE PRINTED FUSE PLOT)
 C      FOR HIGH AND LOW PHANTOM FUSES
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 IOUT(64)
+      CHARACTER IOP
+      CHARACTER*1 IOUT(64)
+      CHARACTER PRODLN
       INTEGER COL,I8PRO,IPROD,ITYPE,OUTPUT
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR
       COMMON /BLK/ PR8X10(10,14),PROD8(8,11),PRODLN(40,7)
 
+      CHARACTER B,N,P,LOFANT,HIFANT,IBLANK
       DATA B/'B'/,N/'N'/,P/'P'/,LOFANT/'0'/,HIFANT/'O'/,IBLANK/' '/
 C     GET OUTPUT GROUPING
       OUTPUT=(IPROD-1)/8+1
@@ -1256,7 +1315,7 @@
 C      AND GENERATES TEST VECTORS
       IMPLICIT INTEGER*1 (A-Z)
 C
-      INTEGER*1 CPG(9999),CLN(80)
+      CHARACTER*1 CPG(9999),CLN(80)
       INTEGER*2 LOF(250),LLN(250),LNPTR,LNMAX
       COMMON /PDS/ LNMAX,LOF,LLN
       COMMON /LINBUF/ CLN,CPG
@@ -1265,22 +1324,30 @@
       COMMON /SPEC/ IPAL,INAME,REST,PATNUM,TITLE,COMP
 C
       INTEGER I,J,IMAX,IC,IC1,IL,IDESC,IEND,IEQN,IEQN1,IL1,ILL,INC
-      INTEGER ILERR,IIFB,IINP,IMATCH,IMESS,IOUT,IOUTP,IPROD,NVECT
-      INTEGER IPCTR1,IPCTR2,IPCTR3,IPCTR4,ISAF,ISUM,ITEST,ITRST,ITYPE
-      INTEGER*1 ISYM(8,24),ISYM1(8,24),IBUF(8,24),IVECTP(24),
-     1        ISTATE(24),ISTATT(24),IPIN(24)
+      CHARACTER IPROD
+      INTEGER ILERR,IIFB,IINP,IMATCH,IMESS,IOUT,IOUTP,NVECT
+      CHARACTER*1 ISUM,ITEST
+      INTEGER IPCTR1,IPCTR2,IPCTR3,IPCTR4,ISAF,ITRST,ITYPE
+      CHARACTER*1 ISYM(8,24),ISYM1(8,24),IBUF(8,24),IVECTP(24),
+     1        ISTATE(24),ISTATT(24)
+      INTEGER *1 IPIN(24)
       INTEGER IPCTR,NTEST,ISUM2,ILE,IONE
       LOGICAL LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR,LSAME,
      1        XORFND,LERR,LPHASE(24),LPHAS1(24),LBUF(24),LOUT(24),
      2        LOUTP(24),LCLOCK,LPTRST,LCTRST,LENABL(24),NREG,
      3        LSA11,LSA12,LSA01,LSA02,LPRINT
+      CHARACTER*1 XORSUM
       COMMON  LBLANK,LLEFT,LAND,LOR,LSLASH,LEQUAL,LRIGHT,LXOR
       COMMON /FTEST/ IFUNCT,IDESC,IEND
-      INTEGER*1 TSTVEC(24, 109 ),IVECT(24)
+      CHARACTER*1 TSTVEC(24, 109 ),IVECT(24)
       COMMON /TSTVEC/ NTEST,TSTVEC
+      CHARACTER IDASH,L,H,X,C,Z,N0,
+     1     N1,ERR,IBLANK,COMENT,NN
       DATA IDASH/'-'/,L/'L'/,H/'H'/,X/'X'/,C/'C'/,Z/'Z'/,N0/'0'/,
      1     N1/'1'/,ERR/'?'/,IBLANK/' '/,COMENT/';'/,NN/'N'/
-      DATA BEL/007/,IONE/1/
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER BEL
+      DATA BEL/BELP/,IONE/1/
       NTEST = 0
 C     PRINT AN ERROR MESSAGE IF NO FUNCTION TABLE IS SUPPLIED
       IF(IFUNCT.NE.0) GO TO 3
@@ -1670,17 +1737,26 @@
       SUBROUTINE HEX(IOP)
 C     THIS SUBROUTINE GENERATES THE INTEL & HEX PROGRAMMING FORMAT
       IMPLICIT INTEGER*1 (A-Z)
+      CHARACTER*1 IOP
       LOGICAL LFUSES(40,80),LPHANT(40,80)
       INTEGER IPROD,IHEX,I,ADDR,IINPUT,CSUM,INC,ISUM2
       INTEGER K,L,HSUM
-      INTEGER*1 ITEMP(2,40),ZCSUM(4),ZTABLE(16) 
+      CHARACTER*1 ZTABLE(16)
+      CHARACTER*1 ITEMP(2,40),ZCSUM(4)
 C
       COMMON /LFUZ/LFUSES,LPHANT
       COMMON /LUNIT/ CONINP,CONOUT,FILINP,FILOUT,PMS,POF,PDF,ROC,RPD
+      CHARACTER, PARAMETER :: SOHP = CHAR(1)
+      CHARACTER, PARAMETER :: BELP = CHAR(7)
+      CHARACTER, PARAMETER :: STXP = CHAR(2)
+      CHARACTER, PARAMETER :: ETXP = CHAR(3)
 C
-      DATA II/'I'/,HH/'H'/,SOH/001/,STX/002/,ETX/003/,BEL/007/,
+      CHARACTER*1 II,HH,SOH,STX,ETX,BEL
+      DATA II/'I'/,HH/'H'/,SOH/SOHP/,STX/STXP/,ETX/ETXP/,BEL/BELP/,
      1    ZTABLE/'0','1','2','3','4','5','6','7',
      2           '8','9','A','B','C','D','E','F'/
+      CHARACTER*1 IBLANK
+      DATA IBLANK/' '/
       ADDR = 0
       HSUM=0
       IF(PDF.NE.CONOUT) WRITE(CONOUT,9000)
@@ -1738,10 +1814,10 @@
 C
 C  ************************************
 C 
-      INTEGER FUNCTION ICONV(K)
+      CHARACTER*1 FUNCTION ICONV(K)
 C
       IMPLICIT INTEGER*1 (A-Z)
-      INTEGER*1 ICNV(16)
+      CHARACTER*1 ICNV(16)
       DATA ICNV/'0','1','2','3','4','5','6','7','8','9',
      1  'A','B','C','D','E','F'/
 C
